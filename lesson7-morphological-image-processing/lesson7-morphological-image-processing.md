# 前言
在本章节当中，我们将会学习到一种新的图像处理方式：形态学图像处理。
# 形态学
  这里的形态学为数字形态学。是一门建立在格论和拓扑学基础之上的图像分析学科，是数学形态学图像处理的基本理论。（摘自百度百科）
## 基础概念
  **集合论基础：**形态学操作将图像看作是像素的集合。例如，一幅二值图像可以视为一个由前景像素（通常是物体部分，像素值为 1）和背景像素（像素值为 0）组成的集合。
  
  **结构元素：**这是形态学操作中的关键部分。它是一个小的集合（可以是简单的形状，如方形、圆形、十字形等），用来在图像上进行探测或者修改操作。比如一个 3×3 的正方形结构元素，它的中心像素与图像中的像素逐个对应进行操作。
## 二值腐蚀和膨胀
### 二值腐蚀与膨胀
#### 腐蚀
**定义：**它是一种收缩或细化二值图像中物体的操作。用结构元素扫描图像中的每个像素，当结构元素与图像中对应的像素集合完全包含在物体像素集合内时，中心像素保留为物体像素，否则将其变为背景像素。

**效果：**可以去除小的物体、分离粘连的物体。例如，在一幅有很多小噪点（被视为小物体）的二值图像中，通过选择合适大小的圆形结构元素进行腐蚀操作，可以去除这些噪点。
      
**数学表示：**用 A 表示图像集合，B 表示结构元素，腐蚀后的集合 AΘB 定义为 $$AΘB = {z|(B) z⊆A}$$其中 (B) z 是结构元素 B 平移后的集合。
#### 膨胀
**定义：**是腐蚀的对偶操作，它会扩张或加粗二值图像中的物体。当结构元素与图像中的像素集合有交集时，中心像素就被判定为物体像素。

**效果：**用于填充物体内部的小孔、连接相邻的物体。比如有一幅二值图像，物体部分有一些小的空洞，通过合适的膨胀操作可以填充这些空洞。

**数学表示：**$$A⊕B = {z|(B) z∩A≠∅}$$
其中 A 是图像集合，B 是结构元素，A⊕B 表示膨胀后的集合。
## 开运算和闭运算
### 开运算
**定义：**先腐蚀后膨胀的操作称为开运算。它可以用于去除图像中的小物体，同时保持较大物体的形状和大小基本不变。

**过程：**假设用 A 表示图像集合，B 表示结构元素，先进行腐蚀操作 AΘB，然后对腐蚀后的结果进行膨胀 (AΘB)⊕B。

**应用场景：**在处理有噪声的二值图像时，开运算可以有效地去除椒盐噪声等孤立的小噪点，同时对物体的主要形状影响较小。
### 闭运算
**定义：**先膨胀后腐蚀的操作。用于填充物体内部的小孔、连接近邻的物体并且基本保持物体的大小不变。

**过程：**对于图像集合 A 和结构元素 B，先膨胀 A⊕B，再腐蚀 (A⊕B)ΘB。

**应用场景：**如果二值图像中的物体有裂缝或者小的间断，闭运算可以将其填充和连接，同时对物体的外部轮廓影响相对较小。
## 击中或击不中变换
**击中变换：**使用一个结构元素对图像进行腐蚀操作，操作完成后保留与结构元素匹配的像素。

**击不中变换：**使用一个结构元素对图像的补集进行腐蚀操作，操作完成后保留与结构元素不匹配的像素。

**击中或击不中变换：**使用两个结构元素，一个用于物体内部的形状匹配，另一个用于物体外部或者背景的形状匹配，操作完成之后，保留能被同时击中与击不中的像素。

**应用：**可以用于检测图像中特定形状的物体，例如在电路板中检测特定形状的焊点。
## 灰度形态学
灰度形态学的基本操作也是腐蚀和膨胀，唯一的区别在于，灰度形态学的运算是基于灰度图像的像素灰度值。

**灰度腐蚀：**用结构元素扫描灰度图像，在每个位置，计算结构元素覆盖下的像素灰度值的最小值作为中心像素的新灰度值。

**灰度膨胀：**用结构元素扫描灰度图像，在每个位置，计算结构元素覆盖下的像素灰度值的最大值作为中心像素的新灰度值。

**灰度开运算：**和二值图像类似，灰度开运算也是先腐蚀后膨胀，用于去除灰度图像中的亮斑和暗斑等噪声。
    
**灰度闭运算：**灰度闭运算先膨胀后腐蚀，用于增强图像中的内部特征的填充。